+++
date = '2025-12-23T21:49:09+09:00'
lastmod = '2025-12-23T21:49:09+09:00'
title = 'HugoとGithub Pagesでこのサイトができるまで'
tags = ["hugo", "github"]
draft = false
+++

先人たちの積み上げた記録がすでにあるので、今更わたしが書いてもオリジナリティは限りなくありませんが、備忘録として書いておきます。\
間違えて認識している部分が大なり小なりあると思うので、鵜呑みにしないでください。

インストール手順について、 [Installation｜Hugo](https://gohugo.io/installation/)に環境に合わせた手順が乗っています。\
また、Github Pagesだけでなく、なんらかのサービスを利用してWEB上に公開する方法も [Host and deploy｜Hugo](https://gohugo.io/host-and-deploy/)にあります。

**公式のドキュメントを参照するのが一番いいです。**

それはさておき、ここではWindowsでHugoを利用する場合について説明していきます。

---

### 概略

1. [必要なツールを用意する](#1-必要なツールを用意する)
2. [Githubにリポジトリを作る](#2-githubにリポジトリを作る)
3. [リポジトリのGithub Pages項目を設定する](#3-リポジトリのgithub-pages項目を設定する)
4. [初期状態のサイトを作成する](#4-初期状態のサイトを作成する)
5. [Github Workflowsを設定する](#5-github-workflowsを設定する)
6. [テーマを導入する](#6-テーマを導入する)
7. [設定ファイルを編集する](#7-設定ファイルを編集する)
8. [ローカルで記事を書く](#8-ローカルで記事を書く)
9. [ローカルサーバーで表示チェックをする](#9-ローカルサーバーで表示チェックをする)
10. [commitをGithubにpushする](#10-commitをgithubにpushする)

### 1. 必要なツールを用意する

[Hugo｜Github](https://github.com/gohugoio/hugo/releases/latest)より、環境に合わせたものをダウンロード、好きな場所(たとえば`D:\Hugo`)に展開してください。\
PATHを通しておくと便利です。\
テーマによっては`Extended`エディションを要求されるので、どれをダウンロードしたらよいかわからない場合は`hugo_extended_<version>_windows-amd64.zip`を選べば問題ないと思います。\
エディションの違いは [Frequently asked questions｜Hugo](https://gohugo.io/troubleshooting/faq/#editions)を参照してください。

[Github](https://github.com/)にログインできるようにします。

[Git for Windows](https://gitforwindows.org/)より、ファイルをダウンロード、インストールしておきます。

エディターとして、vscodeがあれば便利かもしれません。お好みで。

### 2. Githubにリポジトリを作る

Github上に好きな名前(たとえば`hugo-blog`)でリポジトリを作成してください。\
この名前は、`https://<user-name>.github.io/<repository-name>/`のように、Github Pages上のURLに使われます。

なお、通常、リポジトリのvisibilityはpublicで全世界に向けて公開されています。設定をprivateにしてリポジトリを非公開にすることもできますが、その場合、無料ユーザーはprivateなリポジトリをGithub Pagesに使うことはできません。

[GitHub Pages サイトを作成する｜Githubドキュメント](https://docs.github.com/ja/pages/getting-started-with-github-pages/creating-a-github-pages-site)

> リポジトリを所有しているアカウントが GitHub Free または Organization 用の GitHub Free を使用している場合、そのリポジトリはパブリックである必要があります。

次に、作成したリポジトリから、gitのcloneコマンドを使いローカルリポジトリ(たとえば`D:\project\hugo-blog`)を作成します。\
vscodeの場合は`Gitリポジトリのクローン`項目から実行できます。

### 3. リポジトリのGithub Pages項目を設定する

リポジトリの`Settings`ページから`Pages`を開き、`Build and deployment`の項目にある`Source`を`Github Actions`にしてください。\
この設定で、後述する [Github Workflowsを設定する](#5-github-workflowsを設定する)の出力結果が`Github Pages`に渡されるようになります。

### 4. 初期状態のサイトを作成する

ローカルリポジトリの一つ上の階層をターミナルから開いてください。たとえば`D:\project\hugo-blog`がローカルリポジトリならば、`D:\project`です。\
`hugo new site <リポジトリ名> --force`を実行することで、リポジトリフォルダにサイトを構成するファイル群が作成されます。\
`--force`をつけているのは、すでにリモートからクローンしたリポジトリフォルダがあるためです。\
リポジトリ名が`hugo-blog`ならば、`hugo new site hugo-blog --force`となります。

先にローカルでフォルダを作成しておく場合は、`hugo new site <リポジトリ名>`後に`<リポジトリ名>`フォルダに移動し、`git init`コマンドを実行しておきます。

次に、`<リポジトリ名>\.gitignore`ファイルを作成し、テキストエディタで`/public/`と記述してください。\
これは`<リポジトリ名>\public\`フォルダをgitの管理から除外する、という意味です。

`public`フォルダは`hugo build`や`hugo server`コマンドを実行した際に自動で作られるもので、サイトを構築する実際のファイル群が収められています。\
次項で設定するGithub Workflowsを利用する場合は、GitHub側(リモート側)でpublicフォルダを生成するため、ローカルのpublicフォルダをpushしてはいけません。そこで、git管理から除外しています。

### 5. Github Workflowsを設定する

詳しくは公式のドキュメントを参照してください。\
[Host on GitHub Pages｜Hugo](https://gohugo.io/host-and-deploy/host-on-github-pages/)

まず、`<リポジトリ名>\.github\workflows\hugo.yaml`を作成します。\
このファイルは「リポジトリにpushがあった場合、Github側のマシンでhugoを動かし、リポジトリからサイト用ファイルをビルドし、生成されたサイトをGithub Pagesで公開する」という作業の自動化を設定するためのもの。

ファイルの内容は、先程の [Host on GitHub Pages｜Hugo](https://gohugo.io/host-and-deploy/host-on-github-pages/#procedure) より、ProcedureのStep4に書いてあるhugo.yamlをコピペしてください。\
わたしは一部改変して、公式ドキュメントでは`TZ: Europe/Oslo`となっている部分を、`TZ: Asia/Tokyo`として利用しています。

### 6. テーマを導入する

このままではサイトを構築するためのファイルが不足しているので、手軽に問題を解決するためにテーマを導入します。\
[Hugo Themes](https://themes.gohugo.io/)より、好きなテーマ選び、そのドキュメントに示されているインストール手順に沿って導入してください。\
多くのテーマがGithub上で公開されており、`git submodule add`コマンドを使って導入することを推奨していると思います。\
後々の管理のためにも、必ずそれに倣って導入してください。

また、テーマを適用するには必ず設定ファイルである`hugo.toml`を編集する必要があります。

### 7. 設定ファイルを編集する

設定ファイルの位置は`<リポジトリ名>\hugo.toml`です。中身はテキストなので、メモ帳などのテキストエディタで開くことができます。\
設定項目の詳細については、 [Configuration｜Hugo](https://gohugo.io/configuration/)を参照してください。

前段で導入したテーマのドキュメントに従って設定ファイルへ追記します。\
記述内容はテーマによって異なるため、テーマのドキュメントをよく確認してください。

一例として、`hugo-bearblog`テーマを利用した際の`hugo.toml`については、[hugo-bearblog/exampleSite/hugo.toml｜Github](https://github.com/janraasch/hugo-bearblog/blob/master/exampleSite/hugo.toml)に例示されています。

また、Github Pages用に次の内容も追記しておきます。(詳しい解説は [Host on GitHub Pages｜Hugo](https://gohugo.io/host-and-deploy/host-on-github-pages/)参照)

```toml
[caches]
    [caches.images]
        dir = ':cacheDir/images'
```

注意点として、`[]`で囲まれたヘッダー行から始まる一連のブロックはテーブルと呼ばれ、トップレベルの`key = value`形式よりも下の行に配置する必要があります。\
[TOML: 日本語 v1.0.0 #テーブル](https://toml.io/ja/v1.0.0#%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB)によると、こうあります。

> テーブル (ハッシュテーブルや辞書とも呼ばれる) は、キーと値のペアの集まりです。 これらはヘッダーによって定義され、行に角括弧が単独で配置されます\
> (略)\
> その下、次のヘッダーまたは EOF までが、そのテーブルのキーと値のペアです。

たとえば、以下の記述は問題ありません。

```toml
# よい例
title = "Test Site"
theme = "wonderful-theme"

[caches]
    [caches.images]
        dir = ':cacheDir/images'
```

しかし次のようにすると、`title`や`theme`は`[caches.images]`のテーブルに乗ってしまい、Hugoは正しく動作しません。

```toml
# 駄目な例
[caches]
    [caches.images]
        dir = ':cacheDir/images'

title = "Test Site"
theme = "wonderful-theme"
```

### 8. ローカルで記事を書く

これで準備は完了しました（そのはずです）。\
早速記事を書いていきます。

記事は`hugo new <post>`で作成できます。

例として、`hugo new hello-world.md`コマンドを実行してください。`hello-world.md`が`<リポジトリ名>\content\`に出力されるはずです。\
基本的に、こうやって記事を編集していくことになります。

出力されたばかりのファイル内容はテーマによって微妙に異なるため、最低限の例を示しておきます。

```md
+++
date = 'YYYY-MM-DDThh:mm:ss+09:00'
title = 'hello-world'
draft = true
+++
```

この`+++`で囲まれた空間はページのフロントマターと呼ばれるメタデータ群で、たとえば`date`は記事の作成日時を示しています。\
通常、記事へのURLは、たとえば`https://<user-name>.github.io/<repository-name>/hello-world`という具合に、作成したmdのファイル名でアクセスすることになります。メタデータの`title`は表示用で、基本的にURLには影響しません。\
`draft`はファイルが下書き中か否かを示すためのものです。`true`ならば下書き中、`false`ならば脱稿済み、ということになります。\
`draft = true`の記事は、`hugo build`や`hugo server`実行時に構築されるサイトには取り込まれません。ただし、リポジトリ上にmdファイルとしては存在するので、たとえばGithub上のリモートリポジトリならば誰からも閲覧可能です。\
また、テスト用のローカルサーバーの場合は、コマンドラインに引数を加えることで、下書き中のものも表示することができます。(後述)

本文は`+++`で囲まれたフロントマターより下の行にマークダウン記法で書いていきます。

```md
+++
date = 'YYYY-MM-DDThh:mm:ss+09:00'
title = 'hello-world'
draft = true
+++

Hello World !

```

### 9. ローカルサーバーで表示チェックをする

`hugo server`を実行しローカルサーバーを起動させ、表示されるURLをブラウザで開き確認してください。\
初期状態であれば、`http://localhost:1313/`がURLになっているはずです。

`draft = true`のページも表示したい場合は、`hugo server -D`を実行することで下書き中の記事も表示できます。

モバイル機器からの表示を確認したい場合は、ブラウザのウェブ開発ツールを開き、`デバイス エミュレーション`(ブラウザによって名称は異なる)を切り替えることで表示の確認ができます。

ローカルサーバー起動中はファイルの更新を自動で反映されます。

ファイルを変更したにも関わらずローカルサーバーに反映されない場合は、一度ローカルサーバーを`ctrl + c`コマンドで終了させ、publicフォルダを削除後、改めてサーバーを起動してみてください。

### 10. commitをGithubにpushする

問題がないことを確認したら、`draft = false`へと書き換えてcommitし、pushでリモートリポジトリに変更を反映させてください。

push受けて、[Github Workflowsを設定する](#5-github-workflowsを設定する)で設定したActionsが自動で走り、数分とかからずサイトが作成されるはずです。

サイトにアクセスして問題がないことを確認したら、以降は 8 - 10 の繰り返しとなります。

---

以上、基本的な流れでした。

ここまで書いてきてなんですが、初めて試す場合はいきなりGithubとの連携はせず、まずはローカルで試して使用感を確認してからGitやGithubを触ってみるといいかもしれません。

特にテーマに関して、多くのテーマがデモサイトを公開しているものの、読み手として見た時と実際に作り手として触った時の印象は違います。\
試してみたい複数のテーマを`themes`フォルダに配置して、hugo.tomlを編集しつつ自分のサイト構造・記事を使って比較してみることをおすすめします。

Hugoの重要な要素である分類方法について、わたしなりの理解を書いておきます。\
詳しくは [Sections｜Hugo](https://gohugo.io/content-management/sections/)や [Taxonomies｜Hugo](https://gohugo.io/content-management/taxonomies/)を参照してください。

大雑把に言えば、フォルダ構成による分類をセクションと呼び、フロントマターに`tags = ["Hugo", "Github"]`などと記述していく分類をタクソノミーと呼んでいるようです。

セクションは物理的構造に縛られており、また、URLに直結するため、縦軸の分類といえます。\
セクション毎に表示方法を調整でき、このサイトで言えば「[禍話リライト](../maga-rewrite/)」と「[ブログ](../blog/)」はまったく別物として表示されています。

一方で、属性や性質を論理的に分類したものがタクソノミーで、横軸の分類といえるのではないでしょうか。\
公式ドキュメントを見てもわかるように、タクソノミーはサイト作成者がその用途に応じて自由に設定できます。\
たとえば小説を紹介するサイトなら、分類方法は`tags`一つではなく、他にも`author(s)`、`genres`、`publisher`などが考えられますね。場合によっては`series`も必要かもしれません。\
一方で、テーマによってはタクソノミーの利用に縛りがあります。\
柔軟にタクソノミーを利用したい場合は、最終的にテーマを自作していくことになりそうです。

Hugoは [Content adapters](https://gohugo.io/content-management/content-adapters/)という機能を持っており、これを利用することでヘッドレスCMSの記事データを扱えるようになります。\
ただし、そうする場合、Content adaptersで利用するファイル内にサービスのAPIやそれを利用するためのKEYを書かなければならないので、今回記したGithub上にリポジトリを作成する手法そのままではセキュリティ上の問題があります。

たとえContent adapteesを利用しなくても、Github上のリポジトリは設定でprivateにしない限り誰でも閲覧可能、ということは常に念頭に置いておきましょう。